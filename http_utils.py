# coding=utf-8

import re
from random import choice
import requests

import os
import json
import sys
sys.path.append(os.path.abspath('.'))

# from useful_utils.mysql_utils import replace_into_table,list_data_by_columns

BASE_DIR = os.path.abspath(os.path.join(os.path.dirname(__file__),".."))
sys.path.append(BASE_DIR)
# from utils.log import log, ERRORhttps://etherscan.io/
table_name="w_proxies_ip"
schema="web_data"
test_urls=["www.google.com","www.baidu.com","www.youtube.com","www.bing.com"]
# the_proxies=['134.35.200.15:8080', '117.1.104.179:4000', '183.89.59.159:8080', '154.236.189.6:1981', '122.155.165.191:3128', '94.130.147.36:9122']

# the_proxies=['47.74.152.29:8888', '103.231.78.36:80', '216.137.184.253:80', '103.117.192.174:80', '47.91.149.178:8443', '47.254.16.71:5008', '78.46.123.202:80', '142.93.14.238:8888', '154.85.58.149:80', '95.164.89.123:8888']
the_proxies=['94.130.147.36:9122', '5.161.190.231:8080', '5.161.88.129:8080', '134.35.200.15:8080', '175.107.30.94:3128', '117.1.104.179:4000', '183.89.59.159:8080', '154.236.189.6:1981', '5.161.204.70:8080', '150.136.4.250:3128', '183.88.67.90:8080', '103.133.24.50:8080', '103.247.23.69:8080', '1.1.220.100:8080', '102.68.128.215:8080', '125.99.106.250:3128', '38.45.44.2:999', '36.91.98.115:8181', '41.65.55.28:1976']
# the_proxies=["5.252.161.48:3128","150.109.32.166:80","139.162.78.109:3128","47.74.152.29:8888","47.113.90.161:83","05.252.161.48:8080","107.179.33.13:80","185.76.9.123:3128","47.89.153.213:80","181.224.207.21:999","218.1.200.97:57114","139.9.64.238:443","12.231.44.251:3128","5.252.161.48:8080","103.60.161.2:80","139.162.78.109:8080","188.76.188.172:8118","51.250.80.131:80","114.132.165.163:9999","122.155.165.191:3128","149.54.11.76:80","45.114.118.81:3128","59.124.224.205:3128","103.4.94.12:3128","103.231.78.36:80","1.214.62.61:8000","45.152.188.246:3128","167.235.63.238:3128","117.54.114.103:80","62.33.207.202:3128","117.54.114.100:80","185.76.9.87:3128","158.69.52.218:9300","005.252.161.48:8080","182.163.60.105:12345","159.65.133.175:31280","221.6.201.74:9999","47.89.185.178:8888","154.16.63.16:3128","41.65.174.120:1976","154.16.63.16:8080","156.200.116.71:1981","201.49.196.237:53281","173.212.224.134:3129","218.252.244.104:80","95.0.206.22:8080","43.255.113.232:84","110.170.126.13:3128","109.233.191.31:8123","62.33.207.202:80","154.236.177.100:1981","37.233.102.184:3128","37.233.103.130:3128","37.233.102.89:3128","157.100.12.138:999","176.115.197.118:8080","105.112.191.250:3128","62.33.207.202:3128","47.74.152.29:8888","20.203.160.74:3128","139.9.64.238:443","05.252.161.48:8080","82.210.8.173:80","5.252.161.48:3128","47.93.239.66:1080","107.179.33.13:80","185.76.9.123:3128","47.89.153.213:80","12.231.44.251:3128","5.252.161.48:8080","103.60.161.2:80","188.76.188.172:8118","51.250.80.131:80","114.132.165.163:9999","149.54.11.76:80","45.114.118.81:3128","103.4.94.12:3128","103.231.78.36:80","1.214.62.61:8000","45.152.188.246:3128","117.54.114.103:80","117.54.114.100:80","185.76.9.87:3128","005.252.161.48:8080","159.65.133.175:31280","47.89.185.178:8888","154.16.63.16:3128","41.65.174.120:1976","154.16.63.16:8080","156.200.116.71:1981","201.49.196.237:53281","218.252.244.104:80","43.255.113.232:84","62.33.207.202:80","154.236.177.100:1981","37.233.102.184:3128","37.233.103.130:3128","37.233.102.89:3128","157.100.12.138:999","176.115.197.118:8080","105.112.191.250:3128","36.74.71.35:3125","59.60.208.25:7082","62.193.108.137:1981","103.160.40.31:3125","109.74.35.72:8080","119.7.145.78:41122","182.38.124.191:57114","183.239.38.216:9091","50.226.53.178:80","112.135.192.50:8080","113.160.247.27:19132","116.30.160.41:8118","117.30.224.78:7890","134.35.42.200:8080","182.253.175.17:8080","185.104.252.10:9090","200.71.110.152:999","38.240.136.182:8080","94.26.221.214:29999","181.176.211.168:8080","27.157.130.181:7082","50.239.72.16:80","103.105.78.211:3125","111.225.153.166:8089","119.41.200.188:9128","131.255.134.144:8080","157.185.161.123:59394","216.137.184.253:80","20.110.214.83:80","45.156.21.30:7890","47.89.153.213:80","49.76.141.51:5481","49.76.141.70:5481","49.76.141.164:5481","49.76.147.179:5481","49.76.147.183:5481","49.76.147.227:5481","49.76.147.239:5481","50.217.153.78:80","50.227.121.39:80","137.74.90.233:8282","223.241.55.4:57114","223.241.118.88:33080","34.204.2.200:8001","36.25.185.4:8085","41.76.220.79:8088","45.182.41.108:8080","50.216.216.67:80","50.219.7.199:80","50.219.7.204:80","50.219.7.218:80","68.183.191.179:34518","103.105.76.148:3125","103.153.190.109:8080","103.153.246.65:3125","103.155.199.55:3125","103.162.62.18:3125","105.213.16.17:47776","114.238.85.123:57114","114.238.109.217:5481","114.238.113.51:5481","114.238.145.162:5481","114.238.154.21:57114","119.183.179.219:8118","120.43.96.101:8499","120.43.96.170:8499","120.43.134.22:8499","124.161.43.246:7890","161.22.34.194:999","173.82.149.243:8080","182.111.77.238:7082","5.22.208.41:80","45.164.174.247:999","46.36.36.173:8118","50.217.44.154:80","50.223.130.92:80","50.228.83.226:80","50.237.9.180:80","65.37.106.2:80","106.122.195.166:8008","121.236.22.160:33080","146.196.41.161:3125","222.182.113.137:7890","222.214.190.235:9999","39.80.47.32:8060","111.225.152.8:57114","114.232.109.57:8089","117.92.125.62:9128","188.32.190.34:8080","39.105.208.139:22","41.60.233.108:41890","47.111.69.117:8877","49.75.233.29:5481","103.159.221.7:3125","104.248.203.46:3129","113.123.1.17:8888","200.42.203.26:999","200.48.253.49:8080","219.131.241.114:9797","14.207.57.172:8080","27.11.143.223:808","49.82.130.17:5481","49.82.130.28:5481","50.239.72.17:80","106.15.109.140:9999","110.89.121.170:7082","111.193.145.150:8060","116.102.25.241:9812","119.5.225.45:41122","120.196.186.248:9091","183.239.62.251:9091","203.190.113.110:8080","109.194.101.128:3128","119.5.224.234:41122","1.71.132.64:30003","39.107.71.185:22","50.217.22.108:80","50.217.153.72:80","50.219.7.192:80","103.165.253.129:3125","111.225.153.38:8089","114.103.21.183:7082","114.104.102.75:57114","114.104.238.113:57114","114.115.251.155:30001","117.27.115.174:7082","123.132.111.233:8118","140.237.144.237:9128","152.69.231.156:8080","183.166.86.230:57114","188.165.59.127:80","222.85.194.30:9002","39.107.110.171:22","50.204.219.229:80","50.217.153.79:80","50.219.7.215:80","113.13.58.92:8908","125.118.117.52:8888","146.190.231.87:80","180.108.131.89:888","181.198.11.205:8889","14.220.246.62:8118","31.31.184.212:8080","36.65.82.201:8080","36.72.85.139:8080","45.63.23.136:8088","45.71.184.230:999","50.201.108.214:80","50.204.233.30:80","50.219.7.197:80","50.237.89.165:80","68.183.191.179:36571","94.26.211.181:8080","111.225.152.240:8089","125.123.19.230:8118","178.130.80.188:8080","182.160.110.154:9898","216.238.72.163:59394","222.137.16.222:8118","45.182.140.201:999","49.68.228.30:9128","50.227.121.36:80","85.25.91.141:32788","113.118.49.37:7890","114.219.18.139:7890","125.72.106.159:57114","131.0.202.216:8889","134.35.246.20:19090","5.44.254.148:8080","47.94.162.57:22","103.133.26.107:8181","103.175.46.13:3125","103.178.13.44:3125","113.194.143.62:8085","124.193.132.42:9091","146.56.119.252:80","165.16.27.31:1981","178.205.169.210:3128","212.3.135.57:8080","45.91.134.84:8888","47.97.32.179:22","49.207.36.81:80","50.204.57.128:80","50.204.57.130:80","50.204.219.230:80","50.204.219.231:80","50.206.111.91:80","50.216.216.64:80","50.216.216.66:80","50.217.22.104:80","50.217.22.105:80","50.217.44.153:80","50.217.153.77:80","50.218.57.68:80","50.218.57.69:80","50.218.57.74:80","50.219.7.194:80","50.219.7.195:80","50.219.7.196:80","50.219.7.200:80","50.219.7.202:80","50.219.7.205:80","50.219.7.207:80","50.219.7.208:80","50.219.7.214:80","50.219.7.219:80","50.219.7.220:80","50.219.7.222:80","50.219.168.10:80","50.220.21.202:80","50.220.168.134:80","50.223.130.88:80","50.227.121.34:80","50.228.141.100:80","50.231.33.154:80","50.237.9.177:80","50.237.89.160:80","58.208.255.248:33080","62.193.108.133:1976","66.191.31.158:80","80.228.235.2:80","112.193.132.241:8085","114.99.1.139:8499","114.99.4.168:8499","114.99.5.19:9128","114.99.5.169:8499","114.99.7.222:33080","114.99.10.225:8499","114.99.13.32:8499","114.99.18.211:8499","114.99.20.73:3389","114.99.22.102:8499","114.99.109.66:30001","114.99.109.70:30001","114.99.225.223:57114","114.99.227.102:8888","114.103.21.211:7082","114.225.253.252:8877","121.207.92.103:3712","121.207.92.171:3712","121.207.92.182:57114","121.207.93.35:3712","125.72.232.191:57114","182.253.116.66:8080","203.89.126.250:80","212.230.172.6:80","213.143.113.82:80","221.10.198.77:9091","223.247.150.82:9002","27.184.50.2:8089","43.154.71.156:8118","43.154.156.57:3128","45.174.87.18:999","47.110.33.169:8877","50.217.22.114:80","50.228.141.96:80","58.147.185.18:3125","68.183.191.179:34766","68.183.191.179:34857","68.183.191.179:39796","68.183.191.179:43695","68.183.230.116:38561","110.53.52.148:9091","110.138.97.59:8080","111.160.204.146:9091","111.225.152.35:8089","117.157.197.18:3128","119.5.224.13:41122","119.101.110.248:7082","123.56.175.31:3128","178.130.102.73:19090","183.155.81.188:8118","218.87.192.196:7082","223.240.80.168:30003","223.240.89.176:30003","223.247.136.177:30003","223.247.140.188:30003","223.247.150.183:30003","223.247.195.185:30003","223.247.223.39:30003","223.242.8.26:8089","223.242.8.190:8499","223.242.8.200:8089","223.242.9.26:8089","223.242.9.120:8089","223.242.13.35:8089","223.242.13.136:8089","223.242.13.244:8089","223.242.14.94:8499","223.242.15.54:9128","223.242.15.96:8089","223.242.21.4:8089","223.242.21.81:8089","223.242.22.116:8089","223.242.223.153:9128","223.242.246.103:8089","223.242.247.13:57114","223.242.247.88:8089","223.242.247.110:57114","223.242.247.133:8089","110.238.63.238:8080","1.196.21.6:7890","3.95.108.97:80","3.216.45.64:80","3.216.58.165:80","5.252.161.48:3128","8.9.6.190:18087","14.205.195.32:8085","23.94.13.153:8080","27.8.218.168:9091","27.12.69.203:9091","27.150.84.100:7082","27.151.156.8:57114","27.192.138.19:9091","37.21.89.139:8081","41.33.63.178:1981","45.142.106.193:80","45.142.106.194:80","45.232.152.183:48190","49.85.225.105:8888","50.217.153.73:80","51.91.157.66:80","58.17.24.162:9091","58.17.120.182:9091","58.19.201.154:9091","58.221.154.46:9091","58.246.230.195:9002","58.246.231.147:9002","58.252.57.97:9091","59.48.200.158:9091","59.56.142.185:9091","59.57.50.114:9091","59.62.245.222:9091","60.184.139.172:9091","60.210.40.190:9091","60.210.101.166:9091","60.255.139.170:9091","61.132.228.99:8088","61.162.225.180:9091","61.183.234.226:9091","61.190.123.9:9091","62.193.68.86:1976","62.193.108.140:1976","66.29.154.105:3128","68.183.191.179:33861","68.183.191.179:36002","91.238.171.18:8081","95.31.93.248:8081","101.5.168.225:7890","101.5.169.191:7890","101.71.212.27:8085","103.115.252.18:80","103.117.192.174:80","103.155.217.105:41403","103.155.217.105:41404","103.155.217.105:41406","103.155.217.105:41407","103.155.217.105:41408","103.155.217.105:41409","103.155.217.105:41410","103.155.217.105:41411","103.155.217.105:41425","103.155.217.156:41456","103.155.217.156:41460","103.155.217.156:41469","103.155.217.156:41472","103.155.217.156:41475","103.155.217.156:41476","103.155.217.156:41482","103.155.217.156:41483","103.155.217.156:41484","103.155.217.156:41485","103.155.217.156:41487","103.155.217.156:41489","103.155.217.156:41495","103.155.217.156:41497","103.232.215.194:80","110.189.88.20:9091","112.6.117.178:8085","112.14.40.137:9091","112.93.253.99:9091","112.194.207.229:8085","113.70.235.159:8085","113.194.103.179:9091","113.195.4.206:8085","113.195.116.16:8085","115.46.101.50:8085","115.46.102.254:8085","115.207.19.250:9128","115.236.166.106:9091","116.227.168.152:8085","117.12.58.209:9091","117.159.15.99:9091","117.159.37.40:9091","119.41.199.124:7082","119.166.232.125:9091","120.24.33.141:8000","120.132.52.172:8888","120.196.179.73:9091","120.224.145.187:9091","120.237.144.57:9091","120.237.144.77:9091","120.237.144.200:9091","123.115.201.202:8060","123.180.189.135:9091","139.162.78.109:3128","166.111.130.161:7890","171.38.24.176:8085","173.68.63.231:8080","175.17.185.152:8085","176.48.100.25:8081","176.192.70.58:8022","178.45.196.237:8081","178.69.76.211:8081","183.27.250.246:8085","183.172.96.71:7890","183.172.168.165:7890","183.172.177.221:8888","183.172.201.197:7890","183.172.233.23:7890","183.173.19.123:7890","183.173.65.217:7890","183.173.75.120:7890","183.173.120.216:10080","183.215.172.2:9091","183.239.55.65:9091","183.247.215.218:30001","185.148.223.76:3128","187.216.82.55:3128","195.80.49.235:80","195.80.49.237:80","203.150.113.81:57322","211.138.6.37:9091","218.28.98.229:9091","218.75.38.154:9091","218.93.244.138:9091","219.146.125.162:9091","221.2.139.220:9091","221.2.154.27:9091","221.2.214.58:9091","221.10.250.51:9091","221.181.215.78:9091","221.193.240.115:9091","222.89.229.197:9091","222.135.78.201:9091","222.139.156.118:9091","222.139.221.185:9091","222.163.177.78:8908","222.190.154.218:9091","223.82.0.229:9091","223.112.174.62:9091","223.247.182.206:30003","36.91.148.37:8080","39.105.119.23:22","45.5.147.22:8090","45.167.90.21:999","45.230.225.1:666","103.155.19.97:8080","107.179.33.13:80","179.0.176.3:3180","180.211.91.46:3125","190.143.125.25:999","109.2.167.234:3129","117.94.121.255:9000","39.103.173.21:22","47.94.134.17:22","50.221.32.8:80","50.221.32.13:80","50.221.32.15:80","50.227.121.38:80","50.231.110.26:80","60.167.166.22:30003","114.98.233.13:30003","114.98.236.48:30003","114.107.241.43:30003","114.233.70.138:9000","117.69.51.212:57114","121.228.5.10:30003","156.193.17.171:8080","223.240.81.6:30003","223.240.84.1:30003","223.247.194.8:30003","223.247.209.40:30003","223.247.216.28:30003","36.67.27.189:39674","46.176.167.193:3128","50.40.32.90:80","50.201.51.250:80","50.201.108.203:80","50.206.25.104:80","50.206.25.105:80","50.206.25.106:80","50.206.25.108:80","50.206.25.109:80","50.216.216.65:80","50.217.22.107:80","50.217.44.178:80","50.218.57.65:80","50.218.57.66:80","50.219.7.201:80","50.219.7.203:80","50.219.7.206:80","50.219.7.210:80","50.219.7.216:80","50.230.222.202:80","50.237.89.163:80","50.237.89.170:80","60.167.160.187:30003","60.167.167.220:30003","60.167.170.183:30003","114.4.104.254:3128","114.98.225.159:30003","114.98.226.158:30003","114.98.229.57:30003","114.98.233.88:30003","114.98.233.101:30003","114.98.233.105:30003","114.98.235.103:30003","114.107.227.100:30003","114.107.253.165:30003","117.57.58.191:33080","117.66.239.245:30003","118.99.115.195:8080","123.56.157.81:22","128.199.202.122:8080","173.212.216.104:3128","177.185.92.128:3128","222.135.26.189:8060","223.240.72.138:30003","223.240.87.66:30003","223.240.90.59:30003","223.240.94.227:30003","223.240.120.230:30003","223.240.122.67:30003","223.240.122.209:30003","223.247.192.247:30003","223.247.198.134:30003","196.251.221.26:8080","1.85.219.35:7890","1.192.246.174:8060","27.46.55.221:9797","27.150.85.91:7082","27.150.94.248:7082","45.5.118.209:999","45.66.186.122:3128","45.184.92.253:8081","46.35.66.68:8080","47.57.188.208:80","47.91.149.178:8443","49.87.140.199:57114","50.206.111.89:80","50.207.253.118:80","50.218.57.71:80","50.219.7.209:80","50.219.7.217:80","50.223.130.91:80","50.228.141.102:80","50.235.240.86:80","50.237.9.183:80","58.246.58.150:9002","61.51.138.255:7890","62.193.108.139:1976","68.183.230.116:35273","68.183.230.116:37809","68.183.230.116:39599","68.183.230.116:40919","68.183.230.116:45485","94.65.104.9:9812","103.84.131.110:83","103.153.247.50:3125","103.154.230.129:5678","111.167.49.109:7890","113.120.93.157:7890","114.88.1.222:7890","114.234.15.53:8901","116.224.117.133:8001","117.159.23.120:9091","119.101.110.240:7082","119.101.113.122:7082","120.194.219.209:9091","121.199.78.228:8888","122.140.92.242:9091","123.169.102.65:808","125.109.61.34:8118","161.132.210.211:999","171.117.192.206:8118","175.10.138.17:8908","181.118.158.131:999","182.46.214.24:9999","182.92.207.43:22","182.253.155.230:8080","191.6.133.22:2356","194.106.16.41:80","201.91.82.155:3128","203.190.117.145:8080","208.86.249.200:3128","223.84.240.36:9091","223.214.70.186:7082","223.247.150.131:9002","24.95.253.39:80","41.65.174.120:1976","47.254.16.71:5008","50.206.25.111:80","50.217.110.219:80","50.219.7.223:80","50.223.130.34:80","50.227.121.37:80","50.237.9.176:80","50.237.9.182:80","50.237.89.167:80","59.55.209.141:8888","60.205.180.107:22","68.185.57.66:80","95.0.45.58:9812","103.142.200.43:8889","103.148.72.106:80","119.41.195.249:9128","120.196.179.185:9091","121.31.35.149:9091","121.156.109.108:8080","121.206.142.28:7082","183.239.61.204:9091","186.236.1.140:20183","187.102.222.153:27346","201.217.49.2:80","216.238.74.45:59394","221.195.224.4:7890","221.237.209.148:9091","49.81.109.121:57114","49.81.246.56:57114","103.36.8.130:3125","117.89.15.237:82","88.135.89.179:9812","183.21.81.86:41825","27.8.17.198:7890","27.15.26.88:2222","27.157.128.83:7082","27.158.124.150:7082","27.189.6.61:7890","27.191.60.192:57114","27.203.209.49:8060","27.203.246.0:8060","39.80.98.60:8060","39.130.150.23:80","39.165.115.136:9091","45.247.59.41:60080","47.52.225.184:8000","49.89.84.114:57114","49.89.87.211:57114","49.89.127.2:8499","50.217.22.111:80","50.217.44.152:80","50.219.7.212:80","50.223.130.94:80","50.228.141.97:80","50.228.141.98:80","50.239.72.18:80","58.53.126.90:7082","58.253.210.122:8888","60.167.161.189:30003","60.167.167.67:30003","60.176.47.152:8908","60.210.101.118:9091","62.193.108.136:1976","62.193.108.138:1976","64.201.163.133:80","67.212.186.102:80","68.183.191.179:32978","68.183.191.179:33106","68.183.191.179:33516","68.183.191.179:34101","68.183.191.179:34283","68.183.191.179:34572","68.183.191.179:36988","68.183.191.179:37112","68.183.191.179:38416","68.183.191.179:39864","68.183.191.179:39970","68.183.191.179:42310","68.183.191.179:42889","68.183.191.179:46609","68.188.59.198:80","77.73.241.154:80","78.46.123.202:80","91.249.134.148:80","103.148.178.228:80","106.14.255.124:80","106.91.25.14:7890","110.89.122.212:7082","110.238.51.246:8080","111.21.183.58:9091","111.42.175.236:9091","111.72.218.180:9091","111.179.95.216:57114","111.196.175.200:8060","112.25.185.171:9091","112.25.236.167:9091","114.98.224.50:30003","114.98.225.163:30003","114.98.227.59:30003","114.98.228.9:30003","114.98.231.62:30003","114.98.237.218:30003","114.233.185.142:7890","115.52.27.8:81","115.178.97.170:41890","115.227.112.156:8888","116.253.208.239:33080","117.31.59.16:33080","117.66.237.140:30003","117.66.237.141:30003","117.83.27.175:33080","117.159.35.36:9091","118.190.146.252:80","119.41.195.206:7082","119.101.107.21:7082","119.101.113.121:7082","120.82.174.129:9091","122.9.101.6:8888","123.118.98.64:7890","124.239.149.144:30003","125.67.61.237:9091","125.125.16.194:8085","159.89.195.14:80","165.22.60.129:37076","172.99.249.209:80","180.254.114.50:3128","182.99.217.123:7082","182.151.27.241:30003","182.151.160.136:8118","183.166.86.75:8089","183.172.72.174:7890","188.235.5.170:8080","189.163.9.35:8118","194.158.203.14:80","194.180.174.51:3128","203.128.78.194:8181","206.84.97.242:9812","211.142.96.250:9091","218.201.77.143:9091","218.250.242.225:80","222.64.52.228:7890","222.78.2.118:33080","222.78.194.84:9128","223.240.69.63:30003","223.240.90.149:30003","223.240.92.155:30003","223.240.95.44:30003","223.240.100.128:30003","223.240.120.115:30003","223.240.127.77:30003","223.242.14.160:7082","223.247.132.43:30003","223.247.146.248:30003","223.247.194.24:30003","223.247.199.136:30003","223.247.211.15:30003","45.175.26.94:41890","103.156.249.52:8080","122.235.245.63:8118","182.253.72.96:8082","197.246.175.202:1981","49.85.48.37:7082","49.85.48.89:7082","49.85.49.73:7082","49.85.96.40:7082","49.85.97.189:7082","49.85.98.25:7082","49.85.99.66:7082","223.113.101.150:8060","14.20.235.221:808","46.8.216.96:3125","103.153.62.57:3125","111.225.153.55:8089","114.231.41.142:8089","119.7.147.154:41122","183.172.56.162:7890","1.28.72.157:7890","5.79.152.134:8081","14.123.237.27:7890","14.157.96.148:9091","14.177.89.21:19132","20.122.174.106:8888","20.230.193.232:80","20.239.2.157:80","27.158.124.183:7082","27.159.189.63:50024","27.191.60.184:57114","27.191.64.70:9128","27.191.65.143:9128","27.208.67.6:8060","27.208.225.140:8060","31.207.186.97:8081","31.207.218.88:8081","34.87.24.144:8888","36.56.190.129:7082","36.90.160.47:3128","37.112.210.248:55443","37.140.60.86:8081","37.140.65.230:8081","39.80.11.191:8060","39.105.61.139:22","39.105.154.75:22","41.65.0.220:1976","45.67.201.4:80","45.152.188.246:3128","46.44.14.149:8081","47.92.113.71:80","47.104.20.48:1080","47.243.182.203:8081","50.206.25.107:80","54.38.220.159:8081","58.17.77.22:8085","58.17.121.118:9091","58.19.238.36:9091","58.20.235.180:9091","58.53.121.114:7082","58.242.152.22:9091","58.242.152.218:9091","59.48.149.218:7777","60.184.180.49:808","61.240.239.210:9091","62.182.66.185:9090","62.193.108.132:1976","66.29.154.103:3128","91.224.168.22:8080","94.26.204.97:8080","101.5.169.116:7890","103.149.162.195:80","103.152.112.131:80","109.191.0.69:8081","110.136.57.109:8080","110.185.164.20:9091","111.59.182.75:9091","111.225.152.154:8089","112.5.56.2:9091","112.5.72.107:9091","112.25.234.188:9091","112.66.248.66:7082","112.66.251.67:7082","112.250.110.172:9091","113.57.84.39:9091","113.194.88.13:9091","113.194.103.134:9091","113.222.43.50:8088","114.235.83.146:57114","115.226.135.124:1080","115.236.67.98:9091","116.209.101.209:7082","117.40.176.42:9091","117.66.237.222:30003","117.66.237.235:30003","117.68.151.10:8060","117.70.34.238:57114","117.90.58.79:57114","117.95.192.35:57114","117.141.91.123:9091","117.160.132.37:9091","117.160.140.198:9091","117.173.149.211:9091","118.212.152.82:9091","119.3.9.219:8118","119.5.155.57:9091","119.5.225.139:57114","119.7.135.19:9091","119.7.145.150:41122","119.41.195.240:7082","119.41.198.67:9128","119.41.198.145:7082","119.41.201.1:9128","119.41.201.61:9128","119.41.201.62:7082","119.41.201.167:7082","119.41.203.154:9128","119.62.70.40:9091","119.101.54.222:7082","119.101.54.238:7082","119.101.107.19:7082","119.101.113.138:7082","119.180.26.223:9091","119.180.99.168:9091","119.187.131.6:9091","120.41.124.104:7890","120.46.152.244:8888","120.196.188.21:9091","120.237.57.83:9091","121.22.53.166:9091","121.31.21.196:9091","121.31.35.98:9091","121.41.86.254:22","121.225.16.171:7890","121.227.24.164:33080","121.229.133.36:9999","123.54.249.231:57114","123.56.5.35:22","123.163.48.229:9091","124.90.44.90:9091","124.90.70.103:8085","124.112.115.137:9091","125.87.95.193:9128","139.99.237.62:80","140.250.145.55:57114","140.250.148.241:57114","140.250.172.27:57114","142.93.14.238:8888","150.230.104.199:9090","151.30.234.228:3128","151.248.122.52:1081","154.16.63.16:3128","154.85.58.149:80","157.185.163.54:59394","159.223.69.71:3128","171.212.114.11:8118","175.10.215.190:8085","180.175.16.184:8060","180.247.126.193:8080","180.249.93.187:8080","182.99.216.132:7082","183.130.3.190:8060","183.138.1.96:8085","183.143.61.0:27124","183.172.137.123:7890","183.172.225.123:7890","183.172.242.127:7890","183.215.23.242:9091","183.234.253.119:9091","183.239.56.214:9091","183.239.61.167:9091","183.239.62.59:9091","183.250.163.175:9091","186.5.5.126:999","188.254.0.59:80","203.190.42.136:8080","207.180.193.74:16380","210.212.227.68:3128","218.64.253.196:9091","218.89.51.167:9091","218.106.112.241:9091","219.138.229.131:9091","221.2.153.130:9091","221.4.241.198:9091","221.6.215.202:9091","221.181.238.59:9091","221.219.183.99:7890","222.77.85.15:9091","222.85.127.214:9002","222.138.64.93:9091","222.174.10.194:7890","222.179.155.90:9091","222.214.178.80:7890","223.82.39.139:9091","223.94.85.131:9091","223.96.90.216:8085","223.96.94.87:9091","223.240.76.41:30003","223.240.77.195:30003","223.240.87.145:30003","223.240.119.14:30003","223.240.123.156:30003","223.243.65.154:7082","223.247.128.49:30003","223.247.130.12:30003","223.247.130.143:30003","223.247.141.82:30003","223.247.144.207:30003","223.247.178.47:30003","223.247.194.108:30003","223.247.222.148:30003","47.114.121.45:8877","60.168.254.242:8060","124.113.192.47:8089","183.165.226.51:8499","183.165.227.14:8499","183.165.247.37:9128","183.165.249.74:8499","183.165.250.173:8499","200.29.109.112:44749","27.157.159.151:7082","58.147.186.227:3125","66.23.227.3:2019","79.110.40.129:8080","90.64.74.92:8081","103.155.54.73:83","120.39.186.178:57114","121.40.169.87:22","223.214.31.100:8499","223.214.70.147:8499","59.110.50.248:8001","111.225.152.145:8089","156.200.116.68:1981","174.138.62.189:83","176.192.70.58:8008","182.253.158.41:8080","183.157.173.75:8118","3.125.17.202:10101","103.124.198.102:3125","103.146.196.43:3125","117.102.77.122:8080","123.171.42.56:8089","187.193.99.35:8080","14.115.106.113:34100","113.254.164.172:80","167.71.5.83:3128","103.150.154.210:8080","117.69.33.104:8499","176.56.107.134:30274","183.166.91.181:8499","50.206.111.90:80","58.53.126.108:7082","106.14.162.3:22","106.75.84.5:1080","114.245.190.121:8060","117.54.114.100:80","119.123.175.114:9797","175.11.229.149:8880","183.88.106.129:8080","5.22.208.41:443","5.161.105.105:80","36.56.190.80:7082","43.250.107.91:80","45.164.64.112:6969","50.206.25.110:80","50.218.57.70:80","50.219.7.193:80","50.227.121.35:80","50.228.141.101:80","50.237.9.174:80","50.237.9.181:80","85.26.146.169:80","101.83.112.23:8060","103.159.225.17:3125","109.74.32.20:19090","110.16.62.143:8888","113.123.1.34:1080","120.195.150.91:9091","190.58.248.86:80"]
page_num=120
the_proxies=[]


http_proxy = "http://u1512243646:B5oxtkjsZRoW@proxy.123proxy.cn:31920"
https_proxy = "http://u1512243646:B5oxtkjsZRoW@proxy.123proxy.cn:31920"
url = "https://ifconfig.me"
proxySettings = {
    "http": http_proxy,
    "https": https_proxy,
}

def init_ips():
    global the_proxies
    the_proxies=get_ip_from_database()

# init_ips()

def valid_proxies(res_pro=""):
            # res_pro = {'http': "http://"+cur_proxe, 'https':"https://"+ cur_proxe}
    print("cur valid the is ",res_pro)
    cur_proxe=res_pro['http'].replace("http://","")
    global the_proxies
    if cur_proxe not in the_proxies:
        the_proxies.append(cur_proxe)
        print("cur valid proxes is ",the_proxies)
    

def get_proxy_ip_from_api():
    s = requests.session()
    # curl --proxy brd.superproxy.io:22225 --proxy-user brd-customer-hl_8886c077-zone-pachong:6u31737mvgk5  https://lumtest.com/myip.json
    url="https://lumtest.com/myip.json"

# curl --proxy brd.superproxy.io:22225 --proxy-user brd-customer-hl_8886c077-zone-pachong:6u31737mvgk5  https://lumtest.com/myip.json
    # proxy="brd-customer-hl_8886c077-zone-pachong:6u31737mvgk5@brd.superproxy.io:22225"
    proxy="brd-customer-hl_8886c077-zone-pachong-country-us-route_err-pass_dyn:6u31737mvgk5@brd.superproxy.io:22225"
    # proxy="brd-customer-hl_8886c077-zone-pachong-ip-178.171.44.201:6u31737mvgk5@brd.superproxy.io:22225"
    # proxy="brd.superproxy.io:22225:brd-customer-hl_8886c077-zone-pachong-ip-178.171.44.201:6u31737mvgk5"
    
# http://
    proxies = {'http': 'http://'+ proxy, 'https': 'http://'+proxy}
    headers = {
            "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36"
    }

    # response = s.get(url, headers=headers,params={}, timeout=30,proxies=proxies)
    # print(response.text)
    # res_json=json.loads(response.text)
    # res=str(res_json['ip'])+":"+str(res_json['asn']['asnum'])
    # # res=str(res_json['ip'])+":"+str("80")
    # # res=str(res_json['ip'])
    # res_pro = {'http': "http://"+res, 'https':"https://"+ res}
    res_pro = proxies
    print(res_pro)
    # print(proxies)
    return res_pro


def pop_proxes(key_word="normal"):
    global the_proxies
    global page_num

    test_res=False
    # while not test_res:

    if the_proxies==[]:
        # the_proxies=get_random_proxes()
        if key_word=="test":
            the_proxies=get_proxy_ips(num=page_num)
        else:
            init_ips()
            
        page_num=page_num+1
    cur_proxe=the_proxies.pop(0)
    res_pro = {'http': "http://"+cur_proxe, 'https':"https://"+ cur_proxe}

    return res_pro
        # test_res=test_one_proxes(cur_proxe=res_pro)
        # print("cur proxes is ",the_proxies)

default_proxies = {
      'http': '152.32.192.8:8081',
      'https': '152.32.192.8:8081',
}

        # if test_res==200:
        #     # res_pro = {'http': "http://"+cur_proxe, 'https':"https://"+ cur_proxe}
        #     print("cur valid the is ",res_pro)
        #     if cur_proxe not in the_proxies:
        #         the_proxies.append(cur_proxe)
        #     print("cur valid proxes is ",the_proxies)

        #     return res_pro
        # if test_res==429:
        #     if cur_proxe not in the_proxies:
        #         the_proxies.append(cur_proxe)
        #     print("cur valid proxes is ",the_proxies)



    
    # cur_pro="130.162.213.175:8080"
    	
    
    

def get_random_proxes():
    s = requests.session()
    headers = {
            "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36"
        }
    api_proxy_url="https://api.proxyscrape.com/v3/free-proxy-list/get?request=displayproxies&protocol=http&anonymity=all&timeout=50&proxy_format=ipport&format=text"
    response = s.get(api_proxy_url, headers=headers,params={}, timeout=30)

# res=crawl(api_proxy_url)
    proxies_list=str(response.text).split("\r\n")
    proxies_list.pop()
    print(proxies_list)
    
    return  proxies_list
    # with open('2.html', 'w', encoding='utf-8') as f:
    #     f.write(content)


def crawl_response(url,headers=None,proxies=None):
    s = requests.session()
    if headers is  None:
        headers = {
            "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36"
        }
    if proxies is  None:
            response = s.get(url, headers=headers, timeout=30)
    else:
            response = s.get(url, headers=headers, timeout=30,proxies=proxies)
    
    return response
    
def crawl(url="",data=None,headers=None,proxies=None,is_print=False,time_out=30):
    s = requests.session()
    if headers is  None:
        headers = {
            "User-Agent": "Mozilla/5.0 (Windows NT 10.0; rv:109.0) Gecko/20100101 Firefox/115.0"
        }
        # print("header is None")
    # print("header is ",str(headers))
    # print(url)
    if proxies is  None:

            response = s.get(url, headers=headers,params=data, timeout=time_out)
    else:
        if proxies=="random":
            res_code=300
            while res_code != 200:
                # proxies=pop_proxes()
                # proxies=get_proxy_ip_from_api()
                proxies=proxySettings
                print(proxies)
                response = s.get(url, headers=headers,data=data, timeout=time_out,proxies=proxies)
                res_code=response.status_code
                print(res_code)
                # if res_code==429 or res_code==200 :
                #     valid_proxies(proxies)
        else:
                response = s.get(url, headers=headers,data=data, timeout=30,proxies=proxies)
            
                # else:
            #     proxies=pop_proxes()
            
        # if res_code==429 :
        # valid_proxies(proxies)


    if is_print:
        print(response.text)
    # print(response.status_code)
    
    if response.status_code == 200:
        
        encoding = response.encoding

        apparent_encoding = response.apparent_encoding
        # print(encoding,apparent_encoding)
        # text = response.text.encode(encoding).decode('utf-8')
        # print(text)
        text = response.text

        if encoding not in ['utf-8', 'UTF-8']:
            try:
                # text = response.text

                if apparent_encoding in ['utf-8', 'UTF-8', 'UTF-8-SIG']:
                    text = response.text.encode(apparent_encoding).decode('utf8')
                else:
                    if encoding == 'gb2312' and apparent_encoding == 'GB2312':
                        text = response.text.encode('utf8').decode('utf8')
                    elif encoding == 'ISO-8859-1' and apparent_encoding == 'ISO-8859-1':
                        text = response.text.encode('utf8').decode('utf8')
                    elif encoding == 'ISO-8859-1' and apparent_encoding == 'Big5':
                        text = response.text.encode(encoding).decode('big5').encode('utf8').decode('utf8')
                    elif encoding == 'big5' and apparent_encoding == 'Big5':
                        text = response.text.encode(encoding).decode('big5').encode('utf8').decode('utf8')
                    else:
                        text = response.text.encode(encoding).decode('gbk').encode('utf8').decode('utf8')

            except:
                # log(ERROR, '编码错误 [{encoding}] [{url}]'.format(encoding=encoding, url=url))
                return text
        # save_html(text)
        return  response.text

        
    print(response.status_code)
    return False

def crawl_post(url,data,headers=None,proxies=None,is_print=False,timeout=30):
    s = requests.session()

    if headers is None:
        headers = {
            "accept": "*/*",
            "accept-encoding": "gzip, deflate, br",
            "accept-language": "en-US,en;q=0.5",
            "Content-Type":"application/json",
            "User-Agent":"Mozilla/5.0 (Windows NT 10.0; rv:109.0) Gecko/20100101 Firefox/115.0",
            }
    if proxies is None:
        print("here not proxcy")
        response = s.post(url, headers=headers, data=data,timeout=timeout)
    else:
        if proxies=="random":
            res_code=300
            while res_code != 200:
                proxies=pop_proxes()

                try:

                    response = s.get(url, headers=headers,data=data, timeout=timeout,proxies=proxies)
                    res_code=response.status_code
                    # print(res_code,proxies)
                    # if res_code==429 or res_code==200 :
                    #     valid_proxies(proxies)
                except Exception as e:
                    print(e)
                    res_code=300

                    
                
        else:
                response = s.get(url, headers=headers,data=data, timeout=30,proxies=proxies)
            
        response = s.post(url, headers=headers, data=data,timeout=300,proxies=proxies)
    print(response.status_code)
    print(response.encoding)



    if is_print:
        print(response.text)
        print(response)
    if response.status_code == 200 or response.status_code==201:
        text = response.text
        encoding = response.encoding
        apparent_encoding = response.apparent_encoding
        # print(encoding)
        if encoding not in ['utf-8', 'UTF-8']:
            try:
                if apparent_encoding in ['utf-8', 'UTF-8', 'UTF-8-SIG']:
                    text = response.text.encode(apparent_encoding).decode('utf8')
                else:
                    if encoding == 'gb2312' and apparent_encoding == 'GB2312':
                        text = response.text.encode('utf8').decode('utf8')
                    elif encoding == 'ISO-8859-1' and apparent_encoding == 'ISO-8859-1':
                        text = response.text.encode('utf8').decode('utf8')
                    elif encoding == 'ISO-8859-1' and apparent_encoding == 'Big5':
                        text = response.text.encode(encoding).decode('big5').encode('utf8').decode('utf8')
                    elif encoding == 'big5' and apparent_encoding == 'Big5':
                        text = response.text.encode(encoding).decode('big5').encode('utf8').decode('utf8')
                    else:
                        text = response.text.encode(encoding).decode('gbk').encode('utf8').decode('utf8')

            except:
                # log(ERROR, '编码错误 [{encoding}] [{url}]'.format(encoding=encoding, url=url))
                return text
        return text
    return response

def crawl_law_post(url,data,headers=None,proxies=None):
    s = requests.session()
    if headers is None:

        headers = {
            "accept": "*/*",
            "accept-encoding": "gzip, deflate, br",
            "accept-language": "zh-CN,zh;q=0.9",
            # content-length: 9499
            "content-type": "application/x-www-form-urlencoded;charset=UTF-8",
            "cookie": "NID=511=IYnVqj0rvPZo-HMO2fm1MaiI8N_XCmXnCnXsHISz_Jbj_SWb07ICQHxvz8vwpzyAJMyh1hlPzaSd3oHfHjdypKEEi89F77lLgvN38tjAzuHS18HLE2xHjmemPbDYfwO_8K_At0SbqScnP-lV8lOiEG1-QoWwWM7THJoW_TwWGCI; __Host-GAPS=1:EOCPSB3OBNb0yQkoVo7KCBdNyvtBrg:maAnyZUurjdpkALs",
            "google-accounts-xsrf": "1",
            # "origin": "https://accounts.google.com",
            # "referer": "https://accounts.google.com/signup/v2/webcreateaccount?service=mail&continue=https%3A%2F%2Fmail.google.com%2Fmail%2F&ltmpl=default&dsh=S84083465%3A1634177613345442&parent_directed=true&flowName=GlifWebSignIn&flowEntry=SignUp"
            "sec-ch-ua": '"Chromium";v="94", ";Not A Brand";v="99", "Google Chrome";v="94.0.992.38"',
            # sec-ch-ua-mobile: ?0
            "sec-ch-ua-platform": "Windows",
            "sec-fetch-dest": "empty",
            "sec-fetch-mode": "cors",
            "sec-fetch-site": "same-origin",
            "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.71 Safari/537.36",
            "x-same-domain": "1"
        } 
    

    # proxies = {
    #   'http': 'http://129.28.203.109:7890',
    #   'https': 'http://129.28.203.109:7890',
    # }

    if proxies is None:
        print("here not proxcy")
        response = s.post(url, headers=headers, data=data,timeout=30)
    else:
        response = s.post(url, headers=headers, data=data,timeout=30,proxies=proxies)
    # response = s.post(url, headers=headers, data=data,timeout=300)
    print(response.status_code)
    # print(response.text)

    
    if response.status_code == 200 or response.status_code==201:
        text = response.text
        encoding = response.encoding
        apparent_encoding = response.apparent_encoding

        if encoding not in ['utf-8', 'UTF-8']:
            try:
                if apparent_encoding in ['utf-8', 'UTF-8', 'UTF-8-SIG']:
                    text = response.text.encode(apparent_encoding).decode('utf8')
                else:
                    if encoding == 'gb2312' and apparent_encoding == 'GB2312':
                        text = response.text.encode('utf8').decode('utf8')
                    elif encoding == 'ISO-8859-1' and apparent_encoding == 'ISO-8859-1':
                        text = response.text.encode('utf8').decode('utf8')
                    elif encoding == 'ISO-8859-1' and apparent_encoding == 'Big5':
                        text = response.text.encode(encoding).decode('big5').encode('utf8').decode('utf8')
                    elif encoding == 'big5' and apparent_encoding == 'Big5':
                        text = response.text.encode(encoding).decode('big5').encode('utf8').decode('utf8')
                    else:
                        text = response.text.encode(encoding).decode('gbk').encode('utf8').decode('utf8')

            except:
                # log(ERROR, '编码错误 [{encoding}] [{url}]'.format(encoding=encoding, url=url))
                return text
        # save_html(text)
        return text
        
    return False

def test_one_proxes(key_protcol="https",cur_proxe="",timeout=30):
    url=key_protcol+"://"+choice(test_urls)
    print(url)
    s=requests.session()
    
    res=""
    try:    
        res = s.get(url, headers={},params={},proxies=cur_proxe, timeout=timeout)
        print(res.status_code)
        return res.status_code
        # if res.status_code==429 :
        #     global the_proxies
        #     the_proxies.append()
        #     return False
        # if res.status_code==200 :
        #     return True
        
    except Exception as e:
            print(e)
            
            return False
    return False

# def get_ip_from_database(time_out=None):
#     # list_data_by_columns()
#     if time_out==None:
#         datas={
#             # "chain_id":("=",chain_id),
#             "is_valid":("=","1"),
#             "type":("=","https"),
#         }
#     else:
#         datas={
#             # "chain_id":("=",chain_id),
#             "is_valid":("=","1"),
#             "type":("=","https"),
#             "time_out":("=",time_out),
#         }

#     all_datas1=list_data_by_columns(schema=schema,table_name=table_name,datas=datas,limit=1000)
#     # res=int(all_datas1[0][8])
#     ips=[]
#     while(len(all_datas1)>0):
#         ips.append(all_datas1.pop(0)[1])
#     print(ips)

#     return ips

# def test_proxes():
#     valid_proxies=[]
#     # while len(the_proxies)>0:
#     while 1:
#         cur_proxe=pop_proxes("test")
#         # cur_proxe=pop_proxes("random")
#         # test_res=test_one_proxes(cur_proxe=res_pro)
#         the_valid=cur_proxe['http'].replace("http://","")

#         if the_valid  in valid_proxies:
#                 continue 
#         # pop_proxes()
#         res_code=test_one_proxes(cur_proxe=cur_proxe,timeout=1)
#         if res_code in [403,429,200,203,407]:
#             # the_valid=cur_proxe['http'].replace("http://","")
#             # if the_valid not in valided_proxies:
#             the_p=cur_proxe['http'].replace("http://","")
#             cur_data={}
#             cur_data['ip_port']=the_p
#             cur_data['type']="https"
#             cur_data['time_out']="1"
#             valid_proxies.append(cur_data)

#             if len(valid_proxies)>2:
#                 replace_into_table(datas=valid_proxies,table_name='w_proxies_ip',schema='web_data')
#                 valid_proxies=[]
#             print("valid proxy is ",valid_proxies)
        
#         # except:

#         # res=crawl(url=url,proxies=cur_proxe)
           
    
def get_proxy_ips(num=1):

# 抓取代理IP网站的URL
    headers = {
        'Sec-Ch-Ua-Platform':'macOS',
        'Accept-Encoding':'gzip, deflate, br'
        ,'Accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7'
        ,'Cookie':'t=364197963; PAPVisitorId=6d5e7eafadf9f458f3cc50ed4b195afb; sbjs_migrations=1418474375998%3D1; sbjs_current_add=fd%3D2024-01-29%2017%3A16%3A22%7C%7C%7Cep%3Dhttps%3A%2F%2Fhidemy.io%2Fcn%2Fproxy-list%2F%7C%7C%7Crf%3Dhttps%3A%2F%2Fwww.google.com.hk%2F; sbjs_first_add=fd%3D2024-01-29%2017%3A16%3A22%7C%7C%7Cep%3Dhttps%3A%2F%2Fhidemy.io%2Fcn%2Fproxy-list%2F%7C%7C%7Crf%3Dhttps%3A%2F%2Fwww.google.com.hk%2F; sbjs_current=typ%3Dorganic%7C%7C%7Csrc%3Dgoogle%7C%7C%7Cmdm%3Dorganic%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29; sbjs_first=typ%3Dorganic%7C%7C%7Csrc%3Dgoogle%7C%7C%7Cmdm%3Dorganic%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F537.36%20%28KHTML%2C%20like%20Gecko%29%20Chrome%2F120.0.0.0%20Safari%2F537.36; _ym_uid=170651978453394576; _ym_d=1706519784; _gid=GA1.2.1875086360.1706519785; _ym_visorc=w; _ym_isad=2; cjConsent=MHxOfDB8Tnww; cjUser=655b6def-b929-44a0-b67d-c641c01bea3e; _fbp=fb.1.1706519787815.860557234; _tt_enable_cookie=1; _ttp=1634Yq-0ngE4fK5waxVxOV9tyqF; cf_chl_3=7d8f7314a51198b; cf_clearance=mrAWeoZ4DrhXv58_Ibm6Q9126KNTKi5jft1Es0.ICSA-1706519796-1-ARjpk5eCpPe9SexGLkLbtTt8eNUYX3NgDeeoQe7eBC6jHFbDnAm6sM4PkmS5uibheki+taesNF0Cpta2AN5pBCU=; sbjs_session=pgs%3D8%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fhidemy.io%2Fcn%2Fproxy-list%2F%3Ftype%3Dhs%26start%3D128%23list; _ga=GA1.2.2044521818.1706519783; _ga_42493SHRVC=GS1.2.1706519786.1.1.1706520525.60.0.0; _ga_KJFZ3PJZP3=GS1.1.1706519783.1.1.1706520580.4.0.0'
        ,'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36'}

    # res=crawl(url="https://www.kuaidaili.com/free/inha/1/",headers=headers,is_print=False)
    url="https://www.kuaidaili.com/free/fps/"+str(num)
    print(url)
    res=crawl(url=url,headers=headers,is_print=False)
    # print(res)
    ip_res=re.findall(r"\b(?:[0-9]{1,3}\.){3}[0-9]{1,3}\b", res)
    ports=re.findall(r">\d{2,6}</td", res)
    print((ip_res))
    print((ports))
    print(len(ip_res))
    print(len(ports))
    proxy_list=[]
    while len(ip_res)>0:
        cur_ip=ip_res.pop()
        cur_port=ports.pop().replace("</td","").replace(">","")
        # proxy=(cur_ip,cur_port)
        proxy_list.append(cur_ip+":"+cur_port)
        # print(proxy)
        # proxies = {'http': 'http://%s:%s' % proxy, 'https': 'https://%s:%s' % proxy}
        # print(proxies)
        # the_res=crawl("https://www.google.com",is_print=False,proxies=proxies)
        # print(the_res)
        # time.slee
    print(proxy_list)
    return proxy_list

if __name__ == '__main__':
    
    	
    

    # proxies = {'http': 'http://%s:%s' % proxy, 'https': 'https://%s:%s' % proxy}
    #     # print(proxies)
    # url='http://api.twitter.com/graphql/NimuplG1OB7Fd2btCLdBOw/UserByScreenName?variables={"screen_name":"qlonlinde","withSafetyModeUserFields":true}&features={"hidden_profile_likes_enabled":true,"hidden_profile_subscriptions_enabled":true,"responsive_web_graphql_exclude_directive_enabled":true,"verified_phone_label_enabled":false,"subscriptions_verification_info_is_identity_verified_enabled":true,"subscriptions_verification_info_verified_since_enabled":true,"highlights_tweets_tab_ui_enabled":true,"responsive_web_twitter_article_notes_tab_enabled":false,"creator_subscriptions_tweet_preview_api_enabled":true,"responsive_web_graphql_skip_user_profile_image_extensions_enabled":false,"responsive_web_graphql_timeline_navigation_enabled":true}&fieldToggles={"withAuxiliaryUserLabels":false}'

    # # get_random_proxes()
    # # the_res=crawl(url,is_print=True,proxies=proxies)
    # print(the_res)

    # pop_proxes()
    url="https://io.dexscreener.com/dex/log/amm/v3/uniswap/top/ethereum/0xC555D55279023E732CcD32D812114cAF5838fD46?q=0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"
    url="http://39.106.46.212:1080"
    # url="http://www.bjlwhd.com/news.html"
    # data={"enabled":True,"maxSlippage":100,"side":"LONG","downPayment":"200000000000000000","leverage":2,"tokenAddress":"0x30f7c830e0c2f4bec871df809d73e27ef19eb151","functionCallData":""}
    i=0
    while i<10000:
        i+=1
        crawl(url=url,is_print=False)
        print(i)
    # crawl_post(url=url,data=json.dumps(data),is_print=True)
    # get_proxy_ip_from_api()

    # init_ips()

    # test_proxes()
    
    # get_proxy_ips()
    # init_ips()
    # get_ip_from_database()

# 